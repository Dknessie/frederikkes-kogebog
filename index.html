<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vores Hjem</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo="> <!-- Placeholder favicon to prevent 404 error -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>

    <main id="login-page" class="page">
        <div class="login-container">
            <h1 class="app-title">Vores Hjem</h1>
            <p class="app-subtitle">Din digitale assistent til hele huset</p>
            <form id="login-form">
                <div class="input-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" value="frederikke@hjem.dk" required>
                </div>
                <div class="input-group">
                    <label for="password">Adgangskode</label>
                    <input type="password" id="password" value="password123" required>
                </div>
                <button type="submit" class="btn btn-primary">Log ind</button>
                <p id="login-error" class="error-message"></p>
            </form>
        </div>
    </main>

    <div id="app-container" class="hidden">
        <header>
            <div class="header-content">
                <a href="#dashboard" class="header-title-link"><span id="header-title" class="header-title">Vores Hjem</span></a>
                <nav class="desktop-nav">
                    <a href="#dashboard" class="nav-link active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                    <a href="#calendar" class="nav-link"><i class="fas fa-calendar-alt"></i> Kalender</a>
                    <a href="#hjem" class="nav-link"><i class="fas fa-home"></i> Hjem</a>
                    <a href="#recipes" class="nav-link"><i class="fas fa-book-open"></i> Kogebog</a>
                    <a href="#inventory" class="nav-link"><i class="fas fa-boxes-stacked"></i> Varelager</a>
                    <a href="#references" class="nav-link"><i class="fas fa-cogs"></i> Referencer</a>
                </nav>
                 <button id="logout-btn-header" class="btn-logout"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </header>

        <main id="app-main-content">
            <section id="dashboard" class="page">
                <div class="dashboard-layout">
                    <!-- Venstre Kolonne: Prim√¶r Information -->
                    <div class="dashboard-main-column">
                        <div id="welcome-widget" class="dashboard-widget">
                            <h2 id="welcome-title">Velkommen</h2>
                            <p id="welcome-summary">Laster data...</p>
                        </div>
                        <!-- NEW: Timeline Widget -->
                        <div id="timeline-widget" class="dashboard-widget">
                            <div class="widget-header">
                                <h3>Min Tidslinje</h3>
                                <button id="add-event-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilf√∏j</button>
                            </div>
                            <div id="timeline-content"></div>
                        </div>
                        <div id="projects-focus-widget" class="dashboard-widget">
                            <h3>Projekter i Fokus</h3>
                            <div id="projects-focus-content"></div>
                        </div>
                        <div id="category-values-widget" class="dashboard-widget">
                            <h3>Lagerv√¶rdi pr. Kategori</h3>
                            <div id="category-values-content"></div>
                        </div>
                    </div>

                    <!-- H√∏jre Kolonne: Widgets & Hurtig Adgang -->
                    <div class="dashboard-sidebar-column">
                        <div id="shopping-widget" class="dashboard-widget">
                            <h3><i class="fas fa-shopping-cart"></i> Indk√∏b</h3>
                            <div class="shopping-widget-container">
                                <div id="widget-groceries-summary" class="shopping-widget-item groceries clickable">
                                    <div class="shopping-widget-title">
                                        <i class="fas fa-carrot"></i> Dagligvarer
                                    </div>
                                    <div class="shopping-widget-content">
                                        <span id="groceries-count">0 varer</span>
                                    </div>
                                </div>
                                <div id="widget-materials-summary" class="shopping-widget-item materials clickable">
                                    <div class="shopping-widget-title">
                                        <i class="fas fa-hammer"></i> Materialer
                                    </div>
                                     <div class="shopping-widget-content">
                                        <span id="materials-count">0 stk.</span>
                                        <span id="materials-price" class="widget-price">0,00 kr.</span>
                                    </div>
                                </div>
                                <div id="widget-wishlist-summary" class="shopping-widget-item wishlist clickable">
                                     <div class="shopping-widget-title">
                                        <i class="fas fa-couch"></i> √ònskeliste
                                    </div>
                                    <div class="shopping-widget-content">
                                        <span id="wishlist-count">0 √∏nsker</span>
                                        <span id="wishlist-price" class="widget-price">0,00 kr.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="budget-widget" class="dashboard-widget">
                            <div class="card-header">
                                <h3>Budget</h3>
                                <button id="edit-budget-btn" class="btn-icon" title="Rediger budget"><i class="fas fa-edit"></i></button>
                            </div>
                            <div id="budget-gauge-container">
                                <!-- Gauge vil blive renderet her af JS -->
                            </div>
                            <div class="budget-summary">
                                <div class="budget-item">
                                    <span class="budget-label">Forbrug (M√•ned)</span>
                                    <span id="budget-spent" class="budget-value">0,00 kr.</span>
                                </div>
                                <div class="budget-item">
                                    <span class="budget-label">Budget</span>
                                    <span id="budget-total" class="budget-value">4000,00 kr.</span>
                                </div>
                            </div>
                        </div>
                        <div id="inventory-notifications-widget" class="dashboard-widget">
                            <h3>Varelager Notifikationer</h3>
                            <div id="inventory-notifications-content"></div>
                        </div>
                        <div id="quick-actions-widget" class="dashboard-widget">
                            <h3>Hurtig Adgang</h3>
                            <div class="quick-actions-container">
                                <a href="#recipes" data-action="add-recipe" class="quick-action-btn"><i class="fas fa-book-open"></i><span>Ny Opskrift</span></a>
                                <a href="#hjem" data-action="add-project" class="quick-action-btn"><i class="fas fa-tools"></i><span>Nyt Projekt</span></a>
                                <a href="#calendar" class="quick-action-btn"><i class="fas fa-calendar-plus"></i><span>Planl√¶g M√•ltid</span></a>
                                <a href="#inventory" data-action="add-inventory" class="quick-action-btn"><i class="fas fa-box"></i><span>Tilf√∏j Vare</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="calendar" class="page hidden">
                <div class="calendar-main-container">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button id="prev-period-btn" class="btn btn-secondary"><i class="fas fa-chevron-left"></i></button>
                            <div class="calendar-title-wrapper">
                                <h2 id="calendar-title"></h2>
                            </div>
                            <button id="next-period-btn" class="btn btn-secondary"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar-view-toggle">
                            <button id="week-view-btn" class="btn btn-secondary active">Uge</button>
                            <button id="month-view-btn" class="btn btn-secondary">M√•ned</button>
                        </div>
                        <div class="calendar-actions">
                            <button id="generate-groceries-btn" class="btn btn-primary"><i class="fas fa-magic-wand-sparkles"></i> Generer Indk√∏bsliste</button>
                            <button id="clear-meal-plan-btn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Ryd Uge</button>
                        </div>
                    </div>
                    <div id="calendar-week-view" class="calendar-view active">
                        <div class="calendar-week-header"></div>
                        <div id="calendar-grid" class="calendar-grid"></div>
                    </div>
                    <div id="calendar-month-view" class="calendar-view">
                        <div class="calendar-month-header"></div>
                        <div id="calendar-month-grid" class="calendar-month-grid"></div>
                    </div>
                </div>
            </section>
            
            <section id="hjem" class="page hidden">
                <h2>Hjem Administration</h2>
                <div class="hjem-nav-tabs">
                    <button class="hjem-tab active" data-target="hjem-rooms"><i class="fas fa-door-open"></i> Rum</button>
                    <button class="hjem-tab" data-target="hjem-projects"><i class="fas fa-tools"></i> Projekter</button>
                </div>

                <div id="hjem-rooms" class="hjem-subpage active">
                    <div class="actions-bar">
                        <button id="add-room-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilf√∏j Rum Detaljer</button>
                    </div>
                    <div id="rooms-grid" class="recipe-grid"></div>
                </div>

                <div id="hjem-projects" class="hjem-subpage">
                    <div class="actions-bar">
                        <button id="add-project-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilf√∏j Nyt Projekt</button>
                    </div>
                    <div id="projects-grid" class="recipe-grid"></div>
                </div>
            </section>

            <section id="room-details" class="page hidden">
                <div class="room-details-header">
                    <a href="#hjem" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Tilbage til Hjem</a>
                    <h2 id="room-details-title"></h2>
                    <div>
                        <button id="edit-room-btn" class="btn btn-secondary"><i class="fas fa-edit"></i> Rediger Rum Info</button>
                        <button id="add-log-entry-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilf√∏j til Logbog</button>
                    </div>
                </div>
                <div id="room-details-content" class="room-details-grid">
                    <!-- Key info, gallery, wishlist, and logbook will be rendered here -->
                </div>
            </section>

            <section id="recipes" class="page hidden">
                <h2>Kogebog</h2>
                <div class="actions-bar recipe-actions-bar">
                    <button id="add-recipe-btn" class="btn btn-primary">Tilf√∏j ny opskrift</button>
                    <div class="switch-group">
                        <label for="sort-by-stock-toggle">Vis retter jeg kan lave f√∏rst</label>
                        <label class="switch">
                            <input type="checkbox" id="sort-by-stock-toggle">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
                <div id="recipe-filter-container" class="filter-container"></div>
                <div id="recipe-grid" class="recipe-grid"></div>
            </section>
            
            <section id="inventory" class="page hidden">
                <h2>Varelager</h2>
                 <div class="actions-bar">
                    <button id="add-inventory-item-btn" class="btn btn-primary">Tilf√∏j ny vare</button>
                    <button id="reorder-assistant-btn" class="btn btn-secondary"><i class="fas fa-magic-wand-sparkles"></i> Find varer til genbestilling</button>
                    <button id="impulse-purchase-btn" class="btn btn-accent"><i class="fas fa-bolt"></i> Hurtigt K√∏b</button>
                </div>
                <div class="inventory-dashboard">
                    <div class="inventory-summary-bar">
                        <span>Total Lagerv√¶rdi:</span>
                        <span id="inventory-total-value">0,00 kr.</span>
                    </div>
                    <div class="inventory-controls">
                        <div class="search-bar">
                            <input type="text" id="inventory-search-input" placeholder="S√∏g i varelager...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="inventory-filters">
                        <div class="input-group">
                            <label for="inventory-filter-main-category">Overkategori</label>
                            <select id="inventory-filter-main-category"></select>
                        </div>
                        <div class="input-group">
                            <label for="inventory-filter-sub-category">Underkategori</label>
                            <select id="inventory-filter-sub-category"></select>
                        </div>
                         <div class="input-group">
                            <label for="inventory-filter-stock-status">Status</label>
                            <select id="inventory-filter-stock-status">
                                <option value="">Alle</option>
                                <option value="in_stock">P√• lager</option>
                                <option value="low_stock">Lav beholdning</option>
                                <option value="out_of_stock">Ikke p√• lager</option>
                            </select>
                        </div>
                        <button id="clear-inventory-filters-btn" class="btn btn-secondary"><i class="fas fa-filter-circle-xmark"></i> Ryd filtre</button>
                    </div>
                    <div id="inventory-list-container"></div>
                </div>
            </section>

            <section id="references" class="page hidden">
                <h2>Referencer</h2>
                <p>Administr√©r lister og hierarkier, der genbruges i applikationen.</p>
                <div id="references-container" class="references-layout"></div>
            </section>
        </main>

        <nav id="mobile-tab-bar" class="mobile-tab-bar">
            <a href="#dashboard" class="mobile-tab-link active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
            <a href="#calendar" class="mobile-tab-link" data-page="calendar"><i class="fas fa-calendar-alt"></i><span>Kalender</span></a>
            <a href="#hjem" class="mobile-tab-link" data-page="hjem"><i class="fas fa-home"></i><span>Hjem</span></a>
            <a href="#inventory" class="mobile-tab-link" data-page="inventory"><i class="fas fa-boxes-stacked"></i><span>Varelager</span></a>
        </nav>
    </div>
    
    <!-- MODALS -->
    <div id="log-entry-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="log-entry-modal-title">Tilf√∏j til Logbog</h3>
            <form id="log-entry-form">
                <input type="hidden" id="log-entry-id">
                <input type="hidden" id="log-entry-room-id">
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="log-entry-date">Dato</label>
                        <input type="date" id="log-entry-date" required>
                    </div>
                    <div class="input-group">
                        <label for="log-entry-type">Type</label>
                        <select id="log-entry-type" required>
                            <option value="Projekt">üî® Projekt</option>
                            <option value="Vedligehold">üßπ Vedligehold</option>
                            <option value="Note">üìù Note & Info</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label for="log-entry-description">Beskrivelse</label>
                    <textarea id="log-entry-description" rows="4" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-log-entry-btn" class="btn btn-danger" style="display: none; margin-right: auto;">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Note</button>
                </div>
            </form>
        </div>
    </div>
    <div id="event-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="event-modal-title">Tilf√∏j Begivenhed</h3>
            <form id="event-form">
                <input type="hidden" id="event-id">
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="event-date">Dato</label>
                        <input type="date" id="event-date" required>
                    </div>
                    <div class="input-group">
                        <label for="event-type">Kategori</label>
                        <select id="event-type" required>
                            <option value="">V√¶lg type...</option>
                            <option value="To-do">To-do</option>
                            <option value="Aftale">Aftale</option>
                            <option value="F√∏dselsdag">F√∏dselsdag</option>
                            <option value="Udgivelse">Udgivelse</option>
                            <option value="Andet">Andet</option>
                        </select>
                    </div>
                </div>
                <div id="event-title-group" class="input-group">
                    <label for="event-title">Titel</label>
                    <input type="text" id="event-title" required>
                </div>
                <div id="event-type-specific-fields">
                    <!-- Dynamic fields based on type will be inserted here -->
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Gem Begivenhed</button>
                </div>
            </form>
        </div>
    </div>
    <div id="day-details-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="day-details-title"></h3>
            <div id="day-details-content"></div>
            <div class="form-actions">
                <button id="day-details-add-event-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilf√∏j Begivenhed</button>
            </div>
        </div>
    </div>
    <div id="shopping-list-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="shopping-list-header">
                <h3 id="shopping-list-modal-title">Indk√∏bsliste</h3>
                <button class="close-modal-btn">&times;</button>
            </div>
            <div id="shopping-list-modal-content-wrapper">
                <!-- Tematiseret indhold inds√¶ttes her af JS -->
            </div>
        </div>
    </div>
    <div id="room-edit-modal" class="modal-overlay hidden">
        <div class="modal-content large">
            <button class="close-modal-btn">&times;</button>
            <h3 id="room-edit-modal-title">Rediger Rum</h3>
            <form id="room-form">
                <input type="hidden" id="room-id">
                <div class="input-group">
                    <label for="room-name-select">V√¶lg Rum</label>
                    <select id="room-name-select" required></select>
                    <input type="text" id="room-name-display" disabled class="hidden">
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="room-area">St√∏rrelse (m¬≤)</label>
                        <input type="number" id="room-area" step="0.1">
                    </div>
                    <div class="input-group">
                        <label for="room-ceiling-height">Lofth√∏jde (m)</label>
                        <input type="number" id="room-ceiling-height" step="0.01">
                    </div>
                </div>
                <hr>
                <h4>Billeder</h4>
                <div class="input-group">
                    <label for="room-image-url">Tilf√∏j Billede URL</label>
                    <input type="url" id="room-image-url" placeholder="https://...">
                </div>
                <button type="button" id="add-room-image-btn" class="btn btn-secondary">Tilf√∏j Billede</button>
                <div id="room-images-preview-container" class="room-gallery"></div>
                <hr>
                <h4>√ònskeliste</h4>
                <div id="room-wishlist-container"></div>
                <button type="button" id="add-wishlist-item-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j √ònske</button>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Gem Rum</button>
                </div>
            </form>
        </div>
    </div>
    <div id="project-edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="project-edit-modal-title">Rediger Projekt</h3>
            <form id="project-form">
                <input type="hidden" id="project-id">
                
                <div class="project-image-container">
                    <div class="image-upload-container">
                        <h4>F√∏r Billede</h4>
                        <img id="project-image-preview-before" src="https://placehold.co/600x400/f3f0e9/d1603d?text=F√∏r" alt="F√∏r billede af projektet">
                        <div class="image-options">
                            <label for="project-image-upload-before" class="btn btn-secondary"><i class="fas fa-upload"></i> Upload</label>
                            <input type="file" id="project-image-upload-before" accept="image/*" class="hidden">
                            <span class="image-option-divider">/</span>
                            <input type="url" id="project-imageUrl-before" placeholder="Inds√¶t billede URL...">
                        </div>
                    </div>
                    <div class="image-upload-container">
                        <h4>Efter Billede</h4>
                        <img id="project-image-preview-after" src="https://placehold.co/600x400/f3f0e9/d1603d?text=Efter" alt="Efter billede af projektet">
                        <div class="image-options">
                            <label for="project-image-upload-after" class="btn btn-secondary"><i class="fas fa-upload"></i> Upload</label>
                            <input type="file" id="project-image-upload-after" accept="image/*" class="hidden">
                            <span class="image-option-divider">/</span>
                            <input type="url" id="project-imageUrl-after" placeholder="Inds√¶t billede URL...">
                        </div>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="input-group">
                        <label for="project-title">Projekttitel</label>
                        <input type="text" id="project-title" required>
                    </div>
                    <div class="input-group">
                        <label for="project-status">Status</label>
                        <select id="project-status">
                            <option value="Planlagt">Planlagt</option>
                            <option value="Igangv√¶rende" selected>Igangv√¶rende</option>
                            <option value="Afsluttet">Afsluttet</option>
                        </select>
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="project-room">Rum</label>
                        <select id="project-room"></select>
                    </div>
                    <div class="input-group">
                        <label>Estimeret Tid</label>
                        <div class="form-grid-2-col">
                             <input type="number" id="project-time-days" placeholder="Dage">
                             <input type="number" id="project-time-hours" placeholder="Timer">
                        </div>
                    </div>
                </div>
                <div class="input-group">
                    <label for="project-tags">Tags (separer med komma)</label>
                    <input type="text" id="project-tags" placeholder="f.eks. udend√∏rs, tr√¶arbejde, sommer">
                </div>
                <div class="input-group">
                    <label for="project-instructions">Arbejdsplan / Trin</label>
                    <textarea id="project-instructions" rows="8"></textarea>
                </div>
                <hr>
                <h4>Materialer & V√¶rkt√∏j</h4>
                <div id="project-materials-container"></div>
                <button type="button" id="add-material-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j material</button>
                <hr>
                <h4>Inspiration & Links</h4>
                <div id="project-links-container"></div>
                <button type="button" id="add-project-link-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j Link</button>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="save-project-btn">Gem Projekt</button>
                </div>
            </form>
        </div>
    </div>
    <div id="inventory-item-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="inventory-item-modal-title">Administr√©r Vare</h3>
            <form id="inventory-item-form">
                <input type="hidden" id="inventory-item-id">
                
                <div class="form-section-box">
                    <h4>Generel Vareinformation</h4>
                    <p class="small-text">Dette er den generiske vare, som du bruger i dine opskrifter.</p>
                    <div class="input-group">
                        <label for="inventory-item-name">Varenavn (generisk)</label>
                        <input type="text" id="inventory-item-name" placeholder="F.eks. Hakket Kylling" required>
                    </div>
                    <div class="form-grid-2-col">
                        <div class="input-group">
                            <label for="inventory-item-main-category">Overkategori</label>
                            <select id="inventory-item-main-category" required></select>
                        </div>
                        <div class="input-group">
                            <label for="inventory-item-sub-category">Underkategori</label>
                            <select id="inventory-item-sub-category" required></select>
                        </div>
                    </div>
                    <div class="form-grid-2-col">
                        <div class="input-group">
                            <label for="inventory-item-location">Placering i hjemmet</label>
                            <select id="inventory-item-location" required></select>
                        </div>
                        <div class="input-group">
                            <label for="inventory-item-default-unit">Standard M√•leenhed (for total)</label>
                            <select id="inventory-item-default-unit" required>
                                <option value="g">Gram (g)</option>
                                <option value="ml">Milliliter (ml)</option>
                                <option value="stk">Styk (stk)</option>
                            </select>
                        </div>
                    </div>
                     <div class="input-group">
                        <label for="inventory-item-reorder-point">Genbestillingspunkt (valgfri)</label>
                        <input type="number" id="inventory-item-reorder-point" placeholder="F.eks. 500 (i standardenhed)">
                    </div>
                </div>

                <div class="form-section-box">
                    <h4>Konverteringsregler</h4>
                    <p class="small-text">Defin√©r hvordan forskellige enheder skal omregnes til den valgte standard m√•leenhed.</p>
                    <div id="conversion-rules-container"></div>
                    <button type="button" id="add-conversion-rule-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j Regel</button>
                </div>

                <div class="form-section-box">
                    <div class="section-header">
                        <h4>Batches p√• Lager</h4>
                        <button type="button" id="add-batch-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j Nyt Batch</button>
                    </div>
                    <p class="small-text">Dette er de specifikke indk√∏b af varen. Et batch repr√¶senterer √©n eller flere enheder fra samme indk√∏b.</p>
                    <div id="batch-list-container"></div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="delete-inventory-item-btn">Slet Hele Varen</button>
                    <button type="submit" class="btn btn-primary" id="save-inventory-item-btn">Gem Vare</button>
                </div>
            </form>
        </div>
    </div>
    <div id="batch-edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="batch-edit-modal-title">Rediger Batch</h3>
            <form id="batch-edit-form">
                <input type="hidden" id="batch-edit-item-id">
                <input type="hidden" id="batch-edit-batch-id">
                
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="batch-edit-purchase-date">Indk√∏bsdato</label>
                        <input type="date" id="batch-edit-purchase-date" required>
                    </div>
                    <div class="input-group">
                        <label for="batch-edit-expiry-date">Udl√∏bsdato (valgfri)</label>
                        <input type="date" id="batch-edit-expiry-date">
                    </div>
                </div>

                <div class="form-grid-3-col">
                    <div class="input-group">
                        <label for="batch-edit-quantity">Antal</label>
                        <input type="number" id="batch-edit-quantity" min="0" value="1" required>
                    </div>
                    <div class="input-group">
                        <label for="batch-edit-size">V√¶gt/st√∏rrelse pr. enhed</label>
                        <div class="unit-input-wrapper">
                             <input type="number" id="batch-edit-size" min="0" step="any" required>
                             <span id="batch-edit-size-unit"></span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="batch-edit-unit">Enhedstype</label>
                        <input type="text" id="batch-edit-unit" required>
                    </div>
                </div>

                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="batch-edit-price">Pris (total for batch)</label>
                        <div class="price-input-wrapper">
                            <input type="number" id="batch-edit-price" min="0" step="0.01">
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="batch-edit-store">Butik</label>
                        <select id="batch-edit-store" required></select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="delete-batch-btn">Slet Batch</button>
                    <button type="submit" class="btn btn-primary">Gem Batch</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Simplified Impulse Purchase Modal -->
    <div id="impulse-purchase-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Hurtigt K√∏b</h3>
            <p>S√∏g efter en vare for at tilf√∏je et nyt batch, eller opret en ny vare, hvis den ikke findes.</p>
            <form id="impulse-purchase-form">
                <div class="input-group">
                    <label for="impulse-item-search">S√∏g eller opret vare</label>
                    <div class="search-bar">
                        <input type="text" id="impulse-item-search" placeholder="Begynd at skrive for at s√∏ge..." autocomplete="off">
                        <i class="fas fa-search"></i>
                        <div id="impulse-item-suggestions" class="autocomplete-suggestions"></div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="impulse-action-btn" disabled>V√¶lg en handling</button>
                </div>
            </form>
        </div>
    </div>
    <div id="recipe-edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="recipe-edit-modal-title">Rediger opskrift</h3>
            <form id="recipe-form">
                <input type="hidden" id="recipe-id">
                <div class="image-upload-container">
                    <img id="recipe-image-preview" src="https://placehold.co/600x400/f3f0e9/d1603d?text=V√¶lg+billede" alt="Billede af opskrift" onerror="this.onerror=null;this.src='https://placehold.co/600x400/f3f0e9/d1603d?text=Billede+mangler';">
                </div>
                <div class="image-options">
                    <label for="recipe-image-upload" class="btn btn-secondary"><i class="fas fa-upload"></i> Upload billede</label>
                    <input type="file" id="recipe-image-upload" accept="image/*" class="hidden">
                    <span class="image-option-divider">eller</span>
                    <div class="input-group">
                        <label for="recipe-imageUrl">Inds√¶t billede URL</label>
                        <input type="url" id="recipe-imageUrl" placeholder="https://...">
                    </div>
                </div>
                <div class="form-grid">
                    <div class="input-group">
                        <label for="recipe-title">Titel</label>
                        <input type="text" id="recipe-title" required>
                    </div>
                    <div class="input-group">
                        <label for="recipe-category">Kategori</label>
                        <select id="recipe-category">
                            <option value="">V√¶lg kategori...</option>
                            <option value="Aftensmad">Aftensmad</option>
                            <option value="Frokost">Frokost</option>
                            <option value="Morgenmad">Morgenmad</option>
                            <option value="Bagv√¶rk">Bagv√¶rk</option>
                            <option value="Dessert">Dessert</option>
                            <option value="Salat">Salat</option>
                            <option value="Andet">Andet</option>
                        </select>
                    </div>
                     <div class="input-group">
                        <label for="recipe-portions">Antal portioner</label>
                        <input type="number" id="recipe-portions" placeholder="f.eks. 4">
                    </div>
                    <div class="input-group">
                        <label for="recipe-time">Tid (minutter)</label>
                        <input type="number" id="recipe-time" placeholder="f.eks. 30">
                    </div>
                </div>
                <div class="input-group">
                    <label for="recipe-tags">Tags (separer med komma)</label>
                    <input type="text" id="recipe-tags" placeholder="f.eks. nemt, hurtigt, vegetar">
                </div>
                <div class="input-group">
                    <label for="recipe-introduction">Introduktion</label>
                    <textarea id="recipe-introduction" rows="4"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-notes">Noter (valgfri)</label>
                    <textarea id="recipe-notes" rows="4" placeholder="F.eks. tips til servering eller variationer"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-instructions">Fremgangsm√•de</label>
                    <textarea id="recipe-instructions" rows="8"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-source-url">Kilde URL (valgfri)</label>
                    <input type="url" id="recipe-source-url" placeholder="https://...">
                </div>
                <hr>
                <div id="import-section">
                    <h4>Importer Fuld Opskrift eller Ingredienser</h4>
                    <div class="input-group">
                        <label for="recipe-import-textarea">Inds√¶t tekst her</label>
                        <textarea id="recipe-import-textarea" rows="8" placeholder="Inds√¶t fuld opskriftstekst eller kun en ingrediensliste..."></textarea>
                    </div>
                    <button type="button" id="import-recipe-btn" class="btn btn-secondary">Import√©r</button>
                </div>
                <hr>
                <h4>Ingredienser</h4>
                <div id="ingredients-container"></div>
                <button type="button" id="add-ingredient-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilf√∏j ingrediens</button>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="save-recipe-btn">Gem opskrift</button>
                </div>
            </form>
        </div>
    </div>
    <div id="recipe-read-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <div id="recipe-read-view-content">
                <img id="read-view-image" src="" alt="Billede af opskrift" class="read-view-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/f3f0e9/d1603d?text=Billede+mangler';">
                <h3 id="read-view-title"></h3>
                <div class="read-view-meta">
                    <span id="read-view-category"></span>
                    <span id="read-view-time"><i class="fas fa-clock"></i></span>
                    <span id="read-view-portions"><i class="fas fa-users"></i></span>
                    <span id="read-view-price"><i class="fas fa-coins"></i></span>
                </div>
                 <div id="read-view-tags" class="recipe-card-tags"></div>
                <div class="read-view-actions">
                    <button id="read-view-plan-btn" class="btn btn-primary"><i class="fas fa-calendar-plus"></i> Planl√¶g</button>
                    <button id="read-view-cook-btn" class="btn btn-secondary"><i class="fas fa-hat-chef"></i> Mark√©r som lavet</button>
                    <button id="read-view-edit-btn" class="btn btn-secondary"><i class="fas fa-edit"></i> Rediger</button>
                    <button id="read-view-delete-btn" class="btn btn-danger"><i class="fas fa-trash"></i> Slet</button>
                </div>
                <hr>
                <p id="read-view-introduction" class="read-view-introduction"></p>
                <div class="read-view-main-content">
                    <div class="read-view-ingredients">
                        <h4>Ingredienser</h4>
                        <ul id="read-view-ingredients-list"></ul>
                    </div>
                    <div class="read-view-instructions">
                        <h4>Fremgangsm√•de</h4>
                        <div id="read-view-instructions-text"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="notification-modal" class="modal-overlay hidden">
        <div class="modal-content modal-notification">
             <h3 id="notification-title"></h3>
             <p id="notification-message"></p>
             <div id="notification-actions" class="form-actions"></div>
        </div>
    </div>
    <div id="plan-meal-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="plan-meal-modal-title">Planl√¶g M√•ltid</h3>
            <form id="plan-meal-form">
                <input type="hidden" id="plan-meal-recipe-id">
                <div class="input-group">
                    <label for="plan-meal-date">V√¶lg dato</label>
                    <input type="date" id="plan-meal-date" required>
                </div>
                <div class="input-group">
                    <label>V√¶lg m√•ltid</label>
                    <div class="meal-type-selector">
                        <button type="button" class="btn btn-secondary" data-meal="breakfast">Morgen</button>
                        <button type="button" class="btn btn-secondary" data-meal="lunch">Frokost</button>
                        <button type="button" class="btn btn-secondary" data-meal="dinner">Aften</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="plan-meal-portions">Antal portioner</label>
                    <input type="number" id="plan-meal-portions" min="1" step="1" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Tilf√∏j til Madplan</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Add to Calendar Modal -->
    <div id="add-calendar-event-modal" class="modal-overlay hidden">
        <div class="modal-content large">
            <button class="close-modal-btn">&times;</button>
            <h3 id="calendar-event-modal-title">Tilf√∏j til Kalender</h3>
            <div id="calendar-event-view-chooser">
                <p>Hvad vil du tilf√∏je til denne dag?</p>
                <div class="quick-actions-container">
                    <button class="quick-action-btn" data-view="recipe"><i class="fas fa-utensils"></i><span>Madplan</span></button>
                    <button class="quick-action-btn" data-view="project"><i class="fas fa-tasks"></i><span>Projektopgave</span></button>
                    <button class="quick-action-btn" data-view="task"><i class="fas fa-broom"></i><span>Reng√∏ring/Vedligehold</span></button>
                </div>
            </div>
            <!-- Recipe Selection View -->
            <div id="calendar-event-view-recipe" class="calendar-event-view hidden">
                <h4>V√¶lg Opskrift</h4>
                <div class="search-bar">
                    <input type="text" id="calendar-recipe-search" placeholder="S√∏g i dine opskrifter...">
                    <i class="fas fa-search"></i>
                </div>
                <ul id="calendar-recipe-list" class="selection-list"></ul>
            </div>
             <!-- Project Selection View -->
             <div id="calendar-event-view-project" class="calendar-event-view hidden">
                <h4>V√¶lg Projekt</h4>
                <ul id="calendar-project-list" class="selection-list"></ul>
            </div>
             <!-- Task/Maintenance Selection View -->
             <div id="calendar-event-view-task" class="calendar-event-view hidden">
                <h4>V√¶lg Opgave</h4>
                <div class="search-bar">
                    <input type="text" id="calendar-task-search" placeholder="S√∏g eller skriv ny opgave...">
                    <i class="fas fa-search"></i>
                </div>
                <ul id="calendar-task-list" class="selection-list"></ul>
                <form id="calendar-task-form">
                    <input type="hidden" id="calendar-task-name-hidden">
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Tilf√∏j Opgave</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="edit-budget-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Rediger M√•nedligt Budget</h3>
            <form id="edit-budget-form">
                <div class="input-group">
                    <label for="monthly-budget-input">Budget (kr.)</label>
                    <div class="price-input-wrapper">
                        <input type="number" id="monthly-budget-input" min="0" step="100" required>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Gem Budget</button>
                </div>
            </form>
        </div>
    </div>
    <div id="reorder-assistant-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Genbestillings-assistent</h3>
            <p>F√∏lgende varer er ved at l√∏be t√∏r. V√¶lg dem, du vil tilf√∏je til indk√∏bslisten.</p>
            <form id="reorder-form">
                <div id="reorder-list-container"></div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Tilf√∏j valgte til Indk√∏bsliste</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Third-party libraries -->
    <script src="https://cdn.jsdelivr.net/npm/justgage@1.3.5/raphael-2.1.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/justgage@1.3.5/justgage.min.js"></script>

    <script type="module" src="js/app.js"></script>

</body>
</html>
