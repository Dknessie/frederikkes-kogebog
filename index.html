<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frederikkes Kogebog</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo="> <!-- Placeholder favicon to prevent 404 error -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>

    <main id="login-page" class="page">
        <div class="login-container">
            <h1 class="app-title">Frederikkes Kogebog</h1>
            <p class="app-subtitle">Din digitale assistent til hele huset</p>
            <form id="login-form">
                <div class="input-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" value="frederikke@hjem.dk" required>
                </div>
                <div class="input-group">
                    <label for="password">Adgangskode</label>
                    <input type="password" id="password" value="password123" required>
                </div>
                <button type="submit" class="btn btn-primary">Log ind</button>
                <p id="login-error" class="error-message"></p>
            </form>
        </div>
    </main>

    <div id="app-container" class="hidden">
        <header>
            <div class="header-content">
                <a href="#dashboard" class="header-title-link"><span id="header-title" class="header-title">Frederikkes Kogebog</span></a>
                <nav class="desktop-nav">
                    <a href="#dashboard" class="nav-link active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                    <a href="#calendar" class="nav-link"><i class="fas fa-calendar-alt"></i> Kalender</a>
                    <a href="#hjem" class="nav-link"><i class="fas fa-home"></i> Hjemmet</a>
                    <a href="#recipes" class="nav-link"><i class="fas fa-book-open"></i> Kogebog</a>
                    <a href="#inventory" class="nav-link"><i class="fas fa-carrot"></i> Ingredienser</a>
                    <a href="#oekonomi" class="nav-link"><i class="fas fa-chart-pie"></i> Økonomi</a>
                    <a href="#references" class="nav-link"><i class="fas fa-cogs"></i> Referencer</a>
                </nav>
                 <button id="logout-btn-header" class="btn-logout"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </header>

        <main id="app-main-content">
            <section id="dashboard" class="page">
                <div class="dashboard-layout">
                    <!-- Venstre Kolonne: Primær Information -->
                    <div class="dashboard-main-column">
                        <div id="welcome-widget" class="dashboard-widget">
                            <h2 id="welcome-title">Velkommen</h2>
                            <p id="welcome-summary">Laster data...</p>
                        </div>
                        <div id="net-worth-widget" class="dashboard-widget">
                            <h3>Formue Overblik</h3>
                            <div id="net-worth-widget-content"></div>
                        </div>
                        <div id="timeline-widget" class="dashboard-widget">
                            <div class="widget-header">
                                <h3>Min Tidslinje</h3>
                                <button id="add-event-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilføj</button>
                            </div>
                            <div class="timeline-grid">
                                <div id="timeline-birthdays" class="timeline-column">
                                    <h4>Fødselsdage</h4>
                                    <p class="empty-state-small">Ingen fødselsdage fundet.</p>
                                </div>
                                <div id="timeline-events" class="timeline-column">
                                    <h4>Begivenheder</h4>
                                    <p class="empty-state-small">Ingen begivenheder fundet.</p>
                                </div>
                                <div id="timeline-todos" class="timeline-column">
                                    <h4>To-do</h4>
                                    <p class="empty-state-small">Ingen to-do's fundet.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Højre Kolonne: Widgets & Hurtig Adgang -->
                    <div class="dashboard-sidebar-column">
                        <div id="shopping-widget" class="dashboard-widget">
                            <h3><i class="fas fa-shopping-cart"></i> Indkøb</h3>
                            <div class="shopping-widget-container">
                                <div id="widget-groceries-summary" class="shopping-widget-item groceries clickable">
                                    <div class="shopping-widget-title">
                                        <i class="fas fa-carrot"></i> Dagligvarer
                                    </div>
                                    <div class="shopping-widget-content">
                                        <span id="groceries-count">0 varer</span>
                                    </div>
                                </div>
                                <div id="widget-wishlist-summary" class="shopping-widget-item wishlist clickable">
                                    <div class="shopping-widget-title">
                                        <i class="fas fa-gift"></i> Ønskeliste
                                    </div>
                                    <div class="shopping-widget-content">
                                        <span id="wishlist-count">0 ønsker</span>
                                        <span id="wishlist-total" class="widget-price">0,00 kr.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="quick-actions-widget" class="dashboard-widget">
                            <h3>Hurtig Adgang</h3>
                            <div class="quick-actions-container">
                                <a href="#recipes" data-action="add-recipe" class="quick-action-btn"><i class="fas fa-book-open"></i><span>Ny Opskrift</span></a>
                                <a href="#inventory" data-action="add-ingredient" class="quick-action-btn"><i class="fas fa-carrot"></i><span>Tilføj Ingrediens</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- NYT: UGE-HUB LAYOUT FOR KALENDER -->
            <section id="calendar" class="page hidden">
                <div class="weekly-hub-container">
                    <header class="hub-header">
                        <div class="hub-navigation">
                            <button id="hub-prev-week-btn" class="btn btn-secondary"><i class="fas fa-chevron-left"></i> Forrige Uge</button>
                        </div>
                        <h2 id="hub-title" class="hub-title">Uge 36, 2024</h2>
                        <div class="hub-navigation">
                             <button id="hub-next-week-btn" class="btn btn-secondary">Næste Uge <i class="fas fa-chevron-right"></i></button>
                        </div>
                    </header>
                    <div class="hub-actions">
                         <button id="hub-generate-groceries-btn" class="btn btn-primary" disabled><i class="fas fa-magic-wand-sparkles"></i> Generer Indkøbsliste</button>
                         <button id="hub-clear-week-btn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Ryd Hele Ugen</button>
                    </div>

                    <div class="hub-main-layout">
                        <main id="meal-plan-section" class="meal-plan-section">
                            <!-- Dagskort indsættes her af mealPlanner.js -->
                        </main>
                        <aside id="sidebar-section" class="sidebar-section">
                            <div id="events-widget" class="widget-card">
                                <h4><i class="fas fa-star"></i> Ugens Begivenheder</h4>
                                <ul class="widget-list"></ul>
                            </div>
                            <div id="todo-widget" class="widget-card">
                                <h4><i class="fas fa-check-square"></i> Ugens To-Do</h4>
                                <ul class="widget-list"></ul>
                            </div>
                             <div id="shopping-list-widget" class="widget-card shopping-list-widget">
                                <h4><i class="fas fa-shopping-cart"></i> Indkøbsliste</h4>
                                <p>Du har <strong>0</strong> varer på din liste.</p>
                                <button class="btn btn-secondary">Se Indkøbsliste</button>
                            </div>
                        </aside>
                    </div>
                </div>
            </section>

            <section id="hjem" class="page hidden">
                <div class="hjemmet-layout">
                    <aside id="hjemmet-sidebar" class="hjemmet-sidebar"></aside>
                    <main id="hjemmet-main-content" class="hjemmet-main-content"></main>
                </div>
            </section>
            
            <section id="recipes" class="page hidden">
                <div class="cookbook-layout">
                    <main class="cookbook-main">
                        <div class="cookbook-header">
                            <h2>Min Kogebog</h2>
                            <p>Find inspiration, planlæg dine måltider og genopdag dine favoritter.</p>
                            <div class="actions">
                                <button id="cookbook-add-recipe-btn" class="btn btn-primary" disabled><i class="fas fa-plus"></i> Ny Opskrift</button>
                            </div>
                        </div>

                        <div id="recipe-flipper" class="recipe-flipper">
                            <!-- Opskrifter til bladrefunktion indsættes dynamisk af recipes.js -->
                        </div>
                        
                        <div class="flipper-nav">
                            <button id="prev-recipe-btn" class="btn-icon" title="Forrige"><i class="fas fa-chevron-left"></i></button>
                            <button id="next-recipe-btn" class="btn-icon" title="Næste"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        
                        <div class="recipe-list-container">
                            <h3>Alle Mine Opskrifter</h3>
                            <div id="list-filter-tags-container" class="list-filter-tags">
                                <!-- Filter tags indsættes dynamisk af recipes.js -->
                            </div>
                            <div id="recipe-list-grid" class="recipe-list-grid">
                                <!-- Opskriftskort indsættes dynamisk af recipes.js -->
                            </div>
                        </div>
                    </main>

                    <aside class="cookbook-sidebar">
                        <div class="cookbook-widget">
                            <h5><i class="fas fa-search"></i> Find en opskrift</h5>
                            <div class="search-bar">
                                <input id="recipe-search-input-sidebar" type="text" placeholder="Søg efter titel...">
                            </div>
                        </div>

                        <div id="what-can-i-make-widget" class="cookbook-widget">
                            <h5><i class="fas fa-hat-chef"></i> Hvad kan jeg lave</h5>
                            <ul class="widget-list">
                                <!-- Indhold indsættes dynamisk af recipes.js -->
                            </ul>
                        </div>

                        <div id="upcoming-meal-plan-widget" class="cookbook-widget">
                            <h5><i class="fas fa-calendar-day"></i> Kommende Madplan</h5>
                            <ul class="widget-list">
                                <!-- Indhold indsættes dynamisk af recipes.js -->
                            </ul>
                            <button id="go-to-calendar-btn" class="btn btn-secondary" style="width: 100%; margin-top: 1rem;">Se hele madplanen</button>
                        </div>
                    </aside>
                </div>
            </section>

            <section id="inventory" class="page hidden">
                <h2>Ingrediens-bibliotek</h2>
                <p>Administrér generel information om dine ingredienser for at beregne priser og kalorier på opskrifter.</p>
                
                <div class="actions-bar">
                    <button id="add-ingredient-btn" class="btn btn-primary" disabled><i class="fas fa-plus"></i> Tilføj Ny Ingrediens</button>
                    <button id="text-import-btn" class="btn btn-secondary"><i class="fas fa-file-import"></i> Importer fra Tekst</button>
                    <div class="search-bar" style="max-width: 300px; flex-grow: 1;">
                         <input type="text" id="library-search" placeholder="Søg i biblioteket...">
                    </div>
                     <select id="library-category-filter" style="max-width: 250px;">
                        <!-- Indhold genereres af inventory.js -->
                    </select>
                    <div class="view-toggle-buttons">
                        <button id="view-grid-btn" class="btn-icon active" title="Kort-visning"><i class="fas fa-th-large"></i></button>
                        <button id="view-list-btn" class="btn-icon" title="Liste-visning"><i class="fas fa-list"></i></button>
                    </div>
                </div>

                <div id="ingredient-grid-container" class="recipe-grid">
                    <!-- Indhold (kort) genereres af inventory.js -->
                </div>

                <div class="table-wrapper hidden">
                    <div id="ingredient-library-container">
                        <!-- Indhold (tabel) genereres af inventory.js -->
                    </div>
                </div>
            </section>
            
            <section id="oekonomi" class="page hidden">
                <div class="references-page-layout">
                    <aside class="references-sidebar">
                        <ul id="economy-nav-list" class="references-nav-list">
                        </ul>
                    </aside>
                    <main id="economy-content-area" class="references-content-area">
                    </main>
                </div>
            </section>


            <section id="references" class="page hidden">
                <h2>Referencer</h2>
                <p>Administrér lister og hierarkier, der genbruges i applikationen.</p>
                <div class="references-page-layout">
                    <aside class="references-sidebar">
                        <ul id="references-nav-list" class="references-nav-list">
                            <!-- Navigation links indsættes af JS -->
                        </ul>
                    </aside>
                    <main id="references-content-area" class="references-content-area">
                        <!-- Indhold for den valgte kategori indsættes af JS -->
                    </main>
                </div>
            </section>
        </main>

        <nav id="mobile-tab-bar" class="mobile-tab-bar">
            <a href="#dashboard" class="mobile-tab-link active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
            <a href="#calendar" class="mobile-tab-link" data-page="calendar"><i class="fas fa-calendar-alt"></i><span>Kalender</span></a>
            <a href="#hjem" class="mobile-tab-link" data-page="hjem"><i class="fas fa-home"></i><span>Hjemmet</span></a>
            <a href="#inventory" class="mobile-tab-link" data-page="inventory"><i class="fas fa-carrot"></i><span>Ingredienser</span></a>
            <a href="#oekonomi" class="mobile-tab-link" data-page="oekonomi"><i class="fas fa-chart-pie"></i><span>Økonomi</span></a>
        </nav>
    </div>

    <!-- MODALS -->

    <div id="ingredient-info-modal" class="modal-overlay hidden" data-overlay-closable="false" data-confirm-close="true">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="ingredient-modal-title">Administrér Ingrediens</h3>
            <form id="ingredient-info-form">
                <input type="hidden" id="ingredient-info-id">
                
                <h4>Basis Information</h4>
                <div class="input-group">
                    <label for="ingredient-info-name">Navn på ingrediens (unikt)</label>
                    <input type="text" id="ingredient-info-name" placeholder="Hakket Oksekød 4-7%" required>
                </div>

                <div class="input-group">
                    <label for="ingredient-info-substitute-for">Kan bruges i stedet for (valgfri)</label>
                    <select id="ingredient-info-substitute-for"></select>
                </div>

                <div class="input-group">
                    <label for="ingredient-info-aliases">Aliaser (separer med komma)</label>
                    <input type="text" id="ingredient-info-aliases" placeholder="oksekød, hakket kød, fars">
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="ingredient-info-main-category">Overkategori</label>
                        <select id="ingredient-info-main-category" required></select>
                    </div>
                    <div class="input-group">
                        <label for="ingredient-info-sub-category">Underkategori</label>
                        <select id="ingredient-info-sub-category" required></select>
                    </div>
                </div>

                <hr>

                <h4>Pris & Kalorier (Vejledende)</h4>
                <div class="form-grid-2-col">
                     <div class="input-group">
                        <label for="ingredient-info-price-from">Pris Fra (kr. pr. kg/l/stk)</label>
                        <input type="number" id="ingredient-info-price-from" step="0.01" placeholder="110">
                    </div>
                    <div class="input-group">
                        <label for="ingredient-info-price-to">Pris Til (kr. pr. kg/l/stk)</label>
                        <input type="number" id="ingredient-info-price-to" step="0.01" placeholder="130">
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="ingredient-info-default-unit">Prisenhed</label>
                        <select id="ingredient-info-default-unit" required>
                            <option value="g">Kilogram (kg)</option>
                            <option value="ml">Liter (l)</option>
                            <option value="stk">Styk (stk)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="ingredient-info-calories">Kalorier (pr. 100g/ml)</label>
                        <input type="number" id="ingredient-info-calories" placeholder="250">
                    </div>
                </div>
                <div class="input-group">
                    <label for="ingredient-info-weight-per-piece">Vægt pr. 'stk' (i gram)</label>
                    <input type="number" id="ingredient-info-weight-per-piece" placeholder="Valgfri: 80">
                </div>


                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="delete-ingredient-btn">Slet Ingrediens</button>
                    <button type="submit" class="btn btn-primary" id="save-ingredient-btn">Gem Ingrediens</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="text-import-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Importer Ingredienser fra Tekst</h3>
            <p>Indsæt en liste af ingredienser i tekstfeltet. Adskil hver ingrediens med en tom linje. Systemet ignorerer navne, der allerede findes i biblioteket.</p>
            <p class="small-text"><b>Forventet format:</b><br>
                Navn: Hakket Oksekød<br>
                Aliaser: oksekød, hakket kød, fars <span style="color: #888;">(valgfri)</span><br>
                Overkategori: Dagligvarer<br>
                Underkategori: Kød & Fisk<br>
                Pris/kg: 110 <span style="color: #888;">(eller Pris/l, Pris/stk)</span><br>
                Prisenhed: g <span style="color: #888;">(eller ml, stk)</span><br>
                Kalorier/100g/ml: 250
            </p>
            <form id="text-import-form">
                <div class="input-group">
                    <label for="text-import-textarea">Ingrediensliste</label>
                    <textarea id="text-import-textarea" rows="15" placeholder="Indsæt din liste her..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-file-import"></i> Importér og Opret</button>
                </div>
            </form>
        </div>
    </div>

    <div id="ingredient-assistant-modal" class="modal-overlay hidden">
        <div class="modal-content large">
            <button class="close-modal-btn">&times;</button>
            <h3>Opret Manglende Ingredienser</h3>
            <p>Følgende ingredienser fra opskriften findes ikke i dit bibliotek. Udfyld informationen for at tilføje dem.</p>
            <form id="ingredient-assistant-form">
                <div id="ingredient-assistant-list">
                    <!-- Rækker med manglende ingredienser indsættes her af JS -->
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Gem Alle og Tilføj til Bibliotek</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Other Modals (beholdes) -->
    <div id="project-edit-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3>Nyt Projekt</h3>
            <form id="project-form">
                <input type="hidden" id="project-id">
                <input type="hidden" id="project-room-hidden">
                <div class="input-group">
                    <label for="project-title">Projekttitel</label>
                    <input type="text" id="project-title" required>
                </div>
                <div class="input-group">
                    <label for="project-status">Status</label>
                    <select id="project-status">
                        <option value="Planlagt">Planlagt</option>
                        <option value="Igangværende" selected>Igangværende</option>
                        <option value="Afsluttet">Afsluttet</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-project-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Projekt</button>
                </div>
            </form>
        </div>
    </div>

    <div id="plant-edit-modal" class="modal-overlay hidden">
        <div class="modal-content plant-modal-theme">
            <button class="close-modal-btn">&times;</button>
            <h3 id="plant-modal-title">Ny Plante</h3>
            <form id="plant-form">
                <input type="hidden" id="plant-id">
                <input type="hidden" id="plant-room-hidden">
                <div class="form-grid-2-col">
                    <div>
                        <div class="image-upload-container">
                            <img id="plant-image-preview" src="https://placehold.co/600x400/f3f0e9/d1603d?text=Vælg+billede" alt="Billede af plante">
                            <label for="plant-image-upload" class="btn btn-secondary"><i class="fas fa-upload"></i> Upload billede</label>
                            <input type="file" id="plant-image-upload" accept="image/*" class="hidden">
                        </div>
                        <h4>Basis Info</h4>
                        <div class="input-group">
                            <label for="plant-name">Navn på plante</label>
                            <input type="text" id="plant-name" required>
                        </div>
                        <div class="form-grid-2-col">
                            <div class="input-group">
                                <label for="plant-watering-interval">Vandingsinterval (dage)</label>
                                <input type="number" id="plant-watering-interval" required>
                            </div>
                            <div class="input-group">
                                <label for="plant-last-watered">Sidst vandet</label>
                                <input type="date" id="plant-last-watered" required>
                            </div>
                        </div>
                        <div class="form-grid-2-col">
                            <div class="input-group">
                                <label for="plant-fertilizer-interval">Gødningsinterval (dage)</label>
                                <input type="number" id="plant-fertilizer-interval">
                            </div>
                            <div class="input-group">
                                <label for="plant-last-fertilized">Sidst gødet</label>
                                <input type="date" id="plant-last-fertilized">
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4>Anbefalinger</h4>
                        <div class="form-grid-2-col">
                            <div class="input-group">
                                <label for="plant-light">Lysforhold</label>
                                <select id="plant-light">
                                    <option value="">Vælg...</option>
                                    <option value="Direkte sol">Direkte sol</option>
                                    <option value="Indirekte lys">Indirekte lys</option>
                                    <option value="Skygge">Skygge</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="plant-humidity">Luftfugtighed</label>
                                <select id="plant-humidity">
                                    <option value="">Vælg...</option>
                                    <option value="Høj">Høj</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Lav">Lav</option>
                                </select>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="plant-soil">Jordtype</label>
                            <input type="text" id="plant-soil" placeholder="Kaktusjord, pottemuld med perlite">
                        </div>
                        <div class="input-group">
                            <label for="plant-pot">Pottetype</label>
                            <input type="text" id="plant-pot" placeholder="Terrakotta med dræn, selvvandingspotte">
                        </div>
                        <div class="input-group">
                            <label for="plant-dormancy">Dvaleperiode</label>
                            <input type="text" id="plant-dormancy" placeholder="Vinter (reducer vanding)">
                        </div>
                    </div>
                </div>
                <div class="input-group">
                    <label for="plant-care-guide">Plantevejledning</label>
                    <textarea id="plant-care-guide" rows="4" placeholder="Generelle noter om pasning, omplantning, etc."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-plant-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Plante</button>
                </div>
            </form>
        </div>
    </div>

    <div id="wishlist-item-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3>Nyt Ønske</h3>
            <form id="wishlist-item-form">
                <input type="hidden" id="wish-original-name-key">
                <div class="input-group">
                    <label for="wish-name">Navn på ønske</label>
                    <input type="text" id="wish-name" required>
                </div>
                <div class="input-group">
                    <label for="wish-price">Pris (valgfri)</label>
                    <input type="number" id="wish-price" step="0.01">
                </div>
                <div class="input-group">
                    <label for="wish-image-url">Billede URL (valgfri)</label>
                    <input type="url" id="wish-image-url" placeholder="https://...">
                </div>
                <div class="input-group">
                    <label for="wish-url">Link til produkt (valgfri)</label>
                    <input type="url" id="wish-url" placeholder="https://...">
                </div>
                <div class="input-group">
                    <label for="wish-room">Tilknyt til rum (valgfri)</label>
                    <select id="wish-room"></select>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-wish-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Ønske</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="reminder-edit-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3>Ny Påmindelse</h3>
            <form id="reminder-form">
                <input type="hidden" id="reminder-id">
                <input type="hidden" id="reminder-room-hidden">
                <div class="input-group">
                    <label for="reminder-text">Påmindelse</label>
                    <textarea id="reminder-text" rows="3" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-reminder-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Påmindelse</button>
                </div>
            </form>
        </div>
    </div>

    <div id="maintenance-edit-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3>Ny Vedligeholdelsesopgave</h3>
            <form id="maintenance-form">
                <input type="hidden" id="maintenance-id">
                <input type="hidden" id="maintenance-room-hidden">
                <div class="input-group">
                    <label for="maintenance-task">Opgave</label>
                    <input type="text" id="maintenance-task" required>
                </div>
                <div class="input-group">
                    <label for="maintenance-interval">Interval (dage)</label>
                    <input type="number" id="maintenance-interval" required>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-maintenance-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Opgave</button>
                </div>
            </form>
        </div>
    </div>

    <div id="home-inventory-edit-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3>Nyt Inventar</h3>
            <form id="home-inventory-form">
                <input type="hidden" id="home-inventory-id">
                <input type="hidden" id="home-inventory-room-hidden">
                <div class="input-group">
                    <label for="home-inventory-name">Navn/Model</label>
                    <input type="text" id="home-inventory-name" required>
                </div>
                <div class="input-group">
                    <label for="home-inventory-purchaseDate">Købsdato</label>
                    <input type="date" id="home-inventory-purchaseDate" required>
                </div>
                <div class="input-group">
                    <label for="home-inventory-manualUrl">Link til manual (valgfri)</label>
                    <input type="url" id="home-inventory-manualUrl" placeholder="https://...">
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-home-inventory-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Inventar</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="asset-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="asset-modal-title">Administrer Aktiv</h3>
            <form id="asset-form">
                <input type="hidden" id="asset-id">
                <div class="input-group">
                    <label for="asset-name">Navn på aktiv</label>
                    <input type="text" id="asset-name" required placeholder="Andelsbolig, Volvo V60">
                </div>
                <div class="input-group">
                    <label for="asset-type">Type</label>
                    <select id="asset-type" required></select>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="asset-start-value">Startværdi (kr.)</label>
                        <input type="number" id="asset-start-value" step="any" required>
                    </div>
                    <div class="input-group">
                        <label for="asset-start-date">Startdato</label>
                        <input type="date" id="asset-start-date" required>
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="asset-monthly-contribution">Månedligt Indskud (kr.)</label>
                        <input type="number" id="asset-monthly-contribution" step="any" placeholder="1500">
                    </div>
                    <div class="input-group">
                        <label for="asset-annual-growth-rate">Årligt Afkast/Værdifald (%)</label>
                        <input type="number" id="asset-annual-growth-rate" step="any" placeholder="7 eller -5">
                    </div>
                </div>
                <div class="input-group">
                    <label for="asset-linked-liability">Tilknyttet Gæld (valgfri)</label>
                    <select id="asset-linked-liability" multiple></select>
                </div>
                <div class="input-group-inline">
                    <input type="checkbox" id="asset-include-in-net-worth" checked>
                    <label for="asset-include-in-net-worth">Inkluder i nettoformue</label>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-asset-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Aktiv</button>
                </div>
            </form>
        </div>
    </div>

    <div id="liability-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="liability-modal-title">Administrer Gæld</h3>
            <form id="liability-form">
                <input type="hidden" id="liability-id">
                
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="liability-name">Navn på lån</label>
                        <input type="text" id="liability-name" required placeholder="Boliglån, Billån">
                    </div>
                    <div class="input-group">
                        <label for="liability-type">Type</label>
                        <select id="liability-type" required></select>
                    </div>
                </div>

                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="liability-original-principal">Oprindeligt Lånbeløb (kr.)</label>
                        <input type="number" id="liability-original-principal" step="any">
                    </div>
                    <div class="input-group">
                        <label for="liability-start-date">Startdato</label>
                        <input type="date" id="liability-start-date">
                    </div>
                </div>
                
                <hr>
                
                <div class="form-grid-3-col">
                    <div class="input-group">
                        <label for="liability-current-balance">Nuværende Restgæld (kr.)</label>
                        <input type="number" id="liability-current-balance" step="any" required>
                    </div>
                     <div class="input-group">
                        <label for="liability-interest-rate">Årlig Rente (%)</label>
                        <input type="number" id="liability-interest-rate" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="liability-term-months">Ønsket Løbetid (mdr.)</label>
                        <input type="number" id="liability-term-months" step="1">
                    </div>
                </div>
                 <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="liability-monthly-payment">Månedlig Ydelse (kr.)</label>
                        <input type="number" id="liability-monthly-payment" step="any">
                    </div>
                    <div class="input-group">
                        <label>Beregnet Resterende Løbetid</label>
                        <input type="text" id="liability-remaining-term-display" readonly disabled>
                    </div>
                 </div>
                <div class="input-group-inline">
                    <input type="checkbox" id="liability-include-in-net-worth" checked>
                    <label for="liability-include-in-net-worth">Inkluder i nettoformue</label>
                </div>

                <div class="form-actions">
                     <button type="button" id="delete-liability-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Gæld</button>
                </div>
            </form>
        </div>
    </div>

    <div id="fixed-expense-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Administrer Fast Post</h3>
            <form id="fixed-expense-form">
                <input type="hidden" id="fixed-expense-id-edit">
                <div class="input-group">
                    <label for="fixed-expense-description">Beskrivelse</label>
                    <input type="text" id="fixed-expense-description" required>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="fixed-expense-amount">Beløb (kr.)</label>
                        <input type="number" id="fixed-expense-amount" step="0.01" required>
                    </div>
                    <div class="input-group">
                        <label for="fixed-expense-type">Type</label>
                        <select id="fixed-expense-type" required>
                            <option value="expense">Udgift</option>
                            <option value="income">Indkomst</option>
                        </select>
                    </div>
                </div>
                 <div class="form-grid-2-col">
                    <div class="input-group">
                         <label for="fixed-expense-account">Konto</label>
                        <select id="fixed-expense-account" required></select>
                    </div>
                    <div class="input-group">
                         <label for="fixed-expense-person">Person</label>
                        <select id="fixed-expense-person" required></select>
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="fixed-expense-main-category">Hovedkategori</label>
                        <select id="fixed-expense-main-category" required></select>
                    </div>
                    <div class="input-group">
                        <label for="fixed-expense-sub-category">Underkategori</label>
                        <select id="fixed-expense-sub-category"></select>
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="fixed-expense-frequency">Hyppighed</label>
                        <select id="fixed-expense-frequency" required>
                            <option value="monthly">Månedlig</option>
                            <option value="quarterly">Kvartalsvis</option>
                            <option value="semi-annually">Halvårlig</option>
                            <option value="yearly">Årlig</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="fixed-expense-payment-month">Betalingsmåned (hvis ikke månedlig)</label>
                        <select id="fixed-expense-payment-month">
                            <option value="">Vælg måned</option>
                            <option value="1">Januar</option>
                            <option value="2">Februar</option>
                            <option value="3">Marts</option>
                            <option value="4">April</option>
                            <option value="5">Maj</option>
                            <option value="6">Juni</option>
                            <option value="7">Juli</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">Oktober</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                </div>
                <div class="form-grid-2-col">
                    <div class="input-group">
                        <label for="fixed-expense-start-date-edit">Startdato</label>
                        <input type="date" id="fixed-expense-start-date-edit" required>
                    </div>
                    <div class="input-group">
                        <label for="fixed-expense-end-date-edit">Slutdato (valgfri)</label>
                        <input type="date" id="fixed-expense-end-date-edit">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" id="delete-fixed-expense-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Fast Post</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- NYT: Event Modal -->
    <div id="event-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="event-modal-title">Tilføj Begivenhed</h3>
            <form id="event-form">
                <input type="hidden" id="event-id">
                <div class="input-group">
                    <label for="event-date">Dato</label>
                    <input type="date" id="event-date" required>
                </div>
                <div class="input-group">
                    <label for="event-type">Kategori</label>
                    <select id="event-type" required>
                        <option value="">Vælg type...</option>
                        <option value="To-do">To-do</option>
                        <option value="Aftale">Aftale</option>
                        <option value="Fødselsdag">Fødselsdag</option>
                        <option value="Udgivelse">Udgivelse</option>
                        <option value="Andet">Andet</option>
                    </select>
                </div>
                <div id="event-title-group" class="input-group">
                    <label for="event-title">Titel</label>
                    <input type="text" id="event-title" required>
                </div>
                <div id="event-type-specific-fields"></div>
                <div class="form-actions">
                    <button type="button" id="delete-event-btn" class="btn btn-danger hidden">Slet</button>
                    <button type="submit" class="btn btn-primary">Gem Begivenhed</button>
                </div>
            </form>
        </div>
    </div>
    <div id="day-details-modal" class="modal-overlay hidden">
        <div class="modal-content small">
            <button class="close-modal-btn">&times;</button>
            <h3 id="day-details-title"></h3>
            <div id="day-details-content"></div>
            <div class="form-actions">
                <button id="day-details-add-event-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Tilføj Begivenhed</button>
            </div>
        </div>
    </div>
    <div id="shopping-list-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="shopping-list-header">
                <h3 id="shopping-list-modal-title">Indkøbsliste</h3>
                <button class="close-modal-btn">&times;</button>
            </div>
            <div id="shopping-list-modal-content-wrapper"></div>
        </div>
    </div>
    
    <div id="recipe-edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="recipe-edit-modal-title">Rediger opskrift</h3>
            <form id="recipe-form">
                <input type="hidden" id="recipe-id">
                <div class="image-upload-container">
                    <img id="recipe-image-preview" src="https://placehold.co/600x400/f3f0e9/d1603d?text=Vælg+billede" alt="Billede af opskrift" onerror="this.onerror=null;this.src='https://placehold.co/600x400/f3f0e9/d1603d?text=Billede+mangler';">
                </div>
                <div class="image-options">
                    <label for="recipe-image-upload" class="btn btn-secondary"><i class="fas fa-upload"></i> Upload billede</label>
                    <input type="file" id="recipe-image-upload" accept="image/*" class="hidden">
                    <span class="image-option-divider">eller</span>
                    <div class="input-group">
                        <label for="recipe-imageUrl">Indsæt billede URL</label>
                        <input type="url" id="recipe-imageUrl" placeholder="https://...">
                    </div>
                </div>
                <div class="form-grid">
                    <div class="input-group">
                        <label for="recipe-title">Titel</label>
                        <input type="text" id="recipe-title" required>
                    </div>
                    <div class="input-group">
                        <label for="recipe-category">Kategori</label>
                        <select id="recipe-category">
                            <option value="">Vælg kategori...</option>
                            <option value="Aftensmad">Aftensmad</option>
                            <option value="Frokost">Frokost</option>
                            <option value="Morgenmad">Morgenmad</option>
                            <option value="Bagværk">Bagværk</option>
                            <option value="Dessert">Dessert</option>
                            <option value="Salat">Salat</option>
                            <option value="Andet">Andet</option>
                        </select>
                    </div>
                     <div class="input-group">
                        <label for="recipe-portions">Antal portioner</label>
                        <input type="number" id="recipe-portions" placeholder="4">
                    </div>
                    <div class="input-group">
                        <label for="recipe-time">Tid (minutter)</label>
                        <input type="number" id="recipe-time" placeholder="30">
                    </div>
                </div>
                <div class="input-group">
                    <label for="recipe-tags">Tags (separer med komma)</label>
                    <input type="text" id="recipe-tags" placeholder="nemt, hurtigt, vegetar">
                </div>
                <div class="input-group">
                    <label for="recipe-introduction">Introduktion</label>
                    <textarea id="recipe-introduction" rows="4"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-notes">Noter (valgfri)</label>
                    <textarea id="recipe-notes" rows="4" placeholder="tips til servering eller variationer"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-instructions">Fremgangsmåde</label>
                    <textarea id="recipe-instructions" rows="8"></textarea>
                </div>
                <div class="input-group">
                    <label for="recipe-source-url">Kilde URL (valgfri)</label>
                    <input type="url" id="recipe-source-url" placeholder="https://...">
                </div>
                <hr>
                <div id="import-section">
                    <h4>Importer Fuld Opskrift eller Ingredienser</h4>
                    <div class="input-group">
                        <label for="recipe-import-textarea">Indsæt tekst her</label>
                        <textarea id="recipe-import-textarea" rows="8" placeholder="Indsæt fuld opskriftstekst eller kun en ingrediensliste..."></textarea>
                    </div>
                    <button id="import-recipe-btn" type="button" class="btn btn-secondary">Importér</button>
                </div>
                <hr>
                <h4>Ingredienser</h4>
                <div id="ingredients-container"></div>
                <button id="add-ingredient-btn-recipe" type="button" class="btn btn-secondary"><i class="fas fa-plus"></i> Tilføj ingrediens</button>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="save-recipe-btn">Gem opskrift</button>
                </div>
            </form>
        </div>
    </div>
    <div id="recipe-read-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <div id="recipe-read-view-content">
                <img id="read-view-image" src="" alt="Billede af opskrift" class="read-view-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/f3f0e9/d1603d?text=Billede+mangler';">
                <h3 id="read-view-title"></h3>
                <div class="read-view-meta">
                    <span id="read-view-category"></span>
                    <span id="read-view-time"><i class="fas fa-clock"></i></span>
                    <span id="read-view-portions"><i class="fas fa-users"></i></span>
                    <span id="read-view-price"><i class="fas fa-coins"></i></span>
                    <span id="read-view-calories-100g"><i class="fas fa-fire-alt"></i></span>
                </div>
                 <div id="read-view-tags" class="recipe-card-tags"></div>
                <div class="read-view-actions">
                    <button id="read-view-plan-btn" class="btn btn-primary"><i class="fas fa-calendar-plus"></i> Planlæg</button>
                    <button id="create-missing-ingredients-btn" class="btn btn-accent"><i class="fas fa-magic"></i> Opret Manglende Ingredienser</button>
                    <button id="read-view-edit-btn" class="btn btn-secondary"><i class="fas fa-edit"></i> Rediger</button>
                    <button id="read-view-delete-btn" class="btn btn-danger"><i class="fas fa-trash"></i> Slet</button>
                </div>
                <hr>
                <p id="read-view-introduction" class="read-view-introduction"></p>
                <div class="read-view-main-content">
                    <div class="read-view-ingredients">
                        <h4>Ingredienser</h4>
                        <ul id="read-view-ingredients-list"></ul>
                    </div>
                    <div class="read-view-instructions">
                        <h4>Fremgangsmåde</h4>
                        <div id="read-view-instructions-text"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="notification-modal" class="modal-overlay hidden">
        <div class="modal-content modal-notification">
             <h3 id="notification-title"></h3>
             <p id="notification-message"></p>
             <div id="notification-actions" class="form-actions"></div>
        </div>
    </div>
    <!-- NYT: Modals til kalender -->
    <div id="plan-meal-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3 id="plan-meal-modal-title">Planlæg Måltid</h3>
            <form id="plan-meal-form">
                <input type="hidden" id="plan-meal-recipe-id">
                <div class="input-group">
                    <label for="plan-meal-date">Vælg dato</label>
                    <input type="date" id="plan-meal-date" required>
                </div>
                <div class="input-group">
                    <label>Vælg måltid</label>
                    <div class="meal-type-selector">
                        <button type="button" class="btn btn-secondary" data-meal="breakfast">Morgen</button>
                        <button type="button" class="btn btn-secondary" data-meal="lunch">Frokost</button>
                        <button type="button" class="btn btn-secondary" data-meal="dinner">Aften</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="plan-meal-portions">Antal portioner</label>
                    <input type="number" id="plan-meal-portions" min="1" step="1" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Tilføj til Madplan</button>
                </div>
            </form>
        </div>
    </div>
    <div id="add-calendar-event-modal" class="modal-overlay hidden">
        <div class="modal-content large">
            <button class="close-modal-btn">&times;</button>
            <h3 id="calendar-event-modal-title">Tilføj til Kalender</h3>
            <div id="calendar-event-view-chooser">
                <p>Hvad vil du tilføje til denne dag?</p>
                <div class="quick-actions-container">
                    <button class="quick-action-btn" data-view="recipe"><i class="fas fa-utensils"></i><span>Madplan</span></button>
                    <button class="quick-action-btn" data-view="task"><i class="fas fa-broom"></i><span>Rengøring/Vedligehold</span></button>
                </div>
            </div>
            <div id="calendar-event-view-recipe" class="calendar-event-view hidden">
                <h4>Vælg Opskrift</h4>
                <div class="search-bar">
                    <input type="text" id="calendar-recipe-search" placeholder="Søg i dine opskrifter...">
                    <i class="fas fa-search"></i>
                </div>
                <ul id="calendar-recipe-list" class="selection-list"></ul>
            </div>
             <div id="calendar-event-view-project" class="calendar-event-view hidden">
                <h4>Vælg Projekt</h4>
                <ul id="calendar-project-list" class="selection-list"></ul>
            </div>
             <div id="calendar-event-view-task" class="calendar-event-view hidden">
                <h4>Vælg Opgave</h4>
                <div class="search-bar">
                    <input type="text" id="calendar-task-search" placeholder="Søg eller skriv ny opgave...">
                    <i class="fas fa-search"></i>
                </div>
                <ul id="calendar-task-list" class="selection-list"></ul>
                <form id="calendar-task-form">
                    <input type="hidden" id="calendar-task-name-hidden">
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Tilføj Opgave</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="edit-budget-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <h3>Rediger Månedligt Opsparingsmål</h3>
            <form id="edit-budget-form">
                <div class="input-group">
                    <label for="monthly-savings-goal-input">Månedlig opsparing (kr.)</label>
                    <div class="price-input-wrapper">
                        <input type="number" id="monthly-savings-goal-input" min="0" step="any" required>
                    </div>
                </div>
                <div class="input-group">
                    <label for="linked-savings-asset">Tilknyt til Opsparingsaktiv</label>
                    <select id="linked-savings-asset" required></select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Gem Mål</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Third-party libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/justgage@1.3.5/justgage.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <script type="module" src="js/app.js"></script>

</body>
</html>

